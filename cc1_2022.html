<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>📝 Contrôle continu 1 ✔️ | Algo et prog 2 en Python</title>
	<link href="prism.css" rel="stylesheet"/>
	<link href="style.css" rel="stylesheet"/>
	<!--link rel="icon" href="img/favicon.svg"-->
	<link rel="icon"
			href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='200' height='200' viewBox='0 0 100 100' style='display:block; margin:auto; padding: 0 0 1em 0;'%3E%3Cstyle%3E text %7B text-align: center; fill: white; text-anchor: middle; font-size: 11pt; %3C/style%3E%3Crect fill='hsl(000,50%25, 50%25)' x='0' y='0' width='100' height='100'%3E%3C/rect%3E%3C!--	%3Crect fill='hsl(200,50%25, 50%25)' x='0' y='0' width='100' height='100'%3E%3C/rect%3E--%3E%3Ctext x='50' y='75' style='font-size: 50pt;' id='t'%3E 🐍 %3C/text%3E%3C!--	%3Canimate--%3E%3C!-- xlink:href='%23t'--%3E%3C!-- attributeName='y'--%3E%3C!-- calcMode='spline'--%3E%3C!-- values='60; 90; 60'--%3E%3C!-- keyTimes='0; 0.5; 1'--%3E%3C!-- keySplines='--%3E%3C!-- .42 0 1 1;--%3E%3C!-- 0 0 .59 1;'--%3E%3C!-- dur='2s'--%3E%3C!-- fill='freeze'--%3E%3C!-- repeatCount='indefinite'/%3E--%3E%3C/svg%3E">
</head>
<body>
<div id="conteneur">
	<div id="side_nav_bar">
		<!--svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 100 100" style="display:block; margin:auto; padding: 0 0 1em 0;">
	<style>
		text {
			text-align: center;
			fill: white;
			text-anchor: middle;
			font-size: 11pt;
		}
	</style>
	<rect fill="#4B8BBE" x="0" y="0" width="100" height="100"></rect>
	<text x="50" y="45" style="font-size: 30pt;">
		🐍

	</text>
	<text x="50" y="75" fill="#FFE873">
		Algo et prog 2
	</text>
	<text x="50" y="90" fill="#FFE873">
		en Python
	</text>
</svg-->

<div style="color:#4B8BBE; font-size: 200%; padding: 2%; text-align: center">
	Algo. et prog. 2 en
</div>
<img src="img/python-logo-generic.png" alt="Logo de Python" style="width: 100%; max-width: 19em; display:block; margin:auto;">
<div style="text-align: center; opacity: 0.5; font-size: small">Arnaud COUTURIER - Python 3.10</div>


























		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="index.html">
				Introduction
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_spec_impl_versions.html">
				Spécification, implémentations et versions
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_methodes_exec.html">
				Façons d'exécuter un programme Python
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_memoire_donnees.html">
				Mémoire et modèle de données
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_pass.html">
				L'instruction pass
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_prog_objets.html">
				Programmation objets
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_namespaces_modules.html">
				Namespaces et modules
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_exceptions.html">
				Les exceptions
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_sequences.html">
				Les séquences
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_iterables.html">
				Iterables, iterators
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_iterable_unpacking.html">
				Iterable unpacking
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_boucles_avancees.html">
				Techniques avancées sur les boucles
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_fonc_params.html">
				Fonctions et paramètres
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_dict_set.html">
				Hash et dictionnaires
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_compr_listes.html">
				Compréhension de listes et dictionnaires
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="cm_manip_fich_texte.html">
				Manipulation de fichiers texte
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="td1.html">
				✍️ TD 1 - Calculatrice niv.1 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="tp1.html">
				✏️ TP 1 - Calculatrice niv.2 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="td2.html">
				✍️ TD 2 - Prog. objets niv.1 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="tp2.html">
				✏️ TP 2 - Calculatrice niv.3 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="tp3.html">
				✏️ TP 3 - Calculatrice niv.4 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="td3.html">
				✍️ TD 3 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="tp4.html">
				✏️ TP 4 - Prog. objets niv.2 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☒</span-->
			<a href="tp5.html">
				✏️ TP 5 - Prog. objets niv.3 ✔️
			</a>
		</div>

		<div class="page_actuelle h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="cc1_2022.html">
				📝 Contrôle continu 1 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp6.html">
				✏️ TP 6 - Prog. objets niv.4 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp7.html">
				✏️ TP 7 - Prog. objets niv.5 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp_boutique_1.html">
				✏️ TP 8 - Boutique niv.1 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp_boutique_2.html">
				✏️ TP 9 - Boutique niv.2 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp_pendu_1.html">
				✏️ TP 10 - Jeu du pendu niv.1 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp_pendu_2.html">
				✏️ TP 11 - Jeu du pendu niv.2 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="cc2_2022_taches.html">
				📝 Contrôle continu 2 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="tp_pendu_3.html">
				✏️ TP 12 - Jeu du pendu niv.3 ✔️
			</a>
		</div>

		<div class=" h h1">
			<!--span class="ballot_box">☐</span-->
			<a href="cc3_2022_etudiants.html">
				📝 Contrôle continu 3 ✔️
			</a>
		</div>

	</div>
	<div id="contenu">
		


		
	<h1 data-nb="25" id="📝 Contrôle continu 1 ✔️">📝 Contrôle continu 1 ✔️</h1>
	
	

	<div class="exercice">
<ul>
<li><strong>A faire seul ou en binôme</strong></li>
<li><strong>Date début:</strong> mardi 26 juillet 2022</li>
<li><strong>Date limite pour rendre:</strong> <span style="text-decoration: line-through">mercredi 10 août 2022 à 22h59 (2 semaines au total)</span>,
				<span style="color:red">repoussé à lundi 15 août 2022 à 23h59</span>.
			</li>
<li><strong>A rendre sur Moodle:</strong> soumettre uniquement votre unique fichier .py, dans l'onglet <em>évaluations</em> du cours d'algo. et
				prog. 2 en Python. Rendre un seul fichier par binôme.
			</li>
<li><strong>En cas de retard:</strong> <span style="text-decoration: line-through">10 points en moins par jour en retard</span> <span style="color:red">Aucun retard possible</span>.
			</li>
</ul>
<p>La triche sera <strong>activement</strong> recherchée et sanctionnée par un zéro à toutes les copies identiques ou avec des portions de code non
			négligeables identiques.</p>

		
		<p>Vous allez programmer un tableur de type Excel ou LibreOffice Calc. Il va être évidemment bien plus simple, et uniquement en mode textuel, dans la
			console. Il y a 6 niveaux successifs à compléter, chaque niveau ajoutant une fonctionnalité majeure au tableau mais aussi de la complexité et
			difficulté supplémentaires. Chaque niveau dépend du précédent. Chaque niveau est divisé en plusieurs questions qui rapportent chacune des points. Il
			est conseillé de faire les niveaux dans l'ordre. Ne séparez pas votre programme par niveau, programmez une seule version et allez aussi loin que
			vous pouvez.</p>
<p>Ce CC vous demandera de faire quelques recherches afin de trouver des techniques, fonctions et méthodes de classe en Python qui vous faciliteront le
			travail. Des pistes de solution vous seront proposées pour certaines questions, avec parfois des liens vers la documentation de Python
			correspondante. Cependant, vous êtes libres d'utiliser toutes les techniques que vous voulez, tant que les critères du barême sont respectés. Il y a
			deux exceptions à respecter : pas de triche entre binômes, et pas d'importation de modules autres que ceux de la bibliothèque standard de Python.
			S'il y a utilisation de modules externes, les points ne seront pas comptabilisés pour la question concernée par la fonctionnalité externe
			importée.</p>

		
		<h2 data-nb="25.1" id="Total des points à marquer:">Total des points à marquer:</h2>
<style>
			table {
				border-collapse: collapse;
				text-align: center;
			}

			td {
				padding: .5em;
				border: 1px solid #444;
			}
		</style>
<table>
<tr>
<td>niv. 0</td>
<td>niv. 1</td>
<td>niv. 2</td>
<td>niv. 3</td>
<td>niv. 4</td>
<td>niv. 5</td>
<td>niv. 6</td>
<td>Score max</td>
</tr>
<tr>
<td>4.5</td>
<td>10</td>
<td>15</td>
<td>17</td>
<td>8</td>
<td>5</td>
<td>9 (+3 points bonus)</td>
<td>71.5 / 68.5</td>
</tr>
</table>
		

		
		
		
		<h2 data-nb="25.2" id="Niveau 0: envoi correct du CC">Niveau 0: envoi correct du CC</h2>
<p>4.5 points à marquer.</p>
<p>Vous gagnez des points si vous soumettez un devoir dans la forme demandée.</p>
<ol>
<li><p>(0.5 point) Un seul devoir rendu par binôme. Un seul des deux étudiants envoie le devoir, pas les deux.</p></li>
<li><p>(0.5 point) Le devoir est posté sur Moodle, et pas envoyé par d'autres moyens, tel que email par exemple.</p></li>
<li><p>(0.5 point) Un fichier .py est rendu. Pas plusieurs, et pas d'autre type de fichier tel que zip, doc, docx etc...</p></li>
<li><p>(0.5 point) Les noms et prénoms des deux personnes du binôme sont écrits en haut du fichier .py, en commentaire. Si le devoir est fait seul,
				écrire le nom de la personne seule, pour bien confirmer que le devoir a été fait seul.</p></li>
<li><p>(1 point) Le fichier .py peut être lancé tel quel, il ne provoquera aucune erreur de syntaxe. Il peut ne pas être complet, et provoquer des
				erreurs pour certaines opérations, mais aucune modification du code ne doit être nécessaire pour lancer le programme, il doit être prêt à
				l'emploi.</p></li>
<li><p>(0.5 point) Aucune importation de modules externes, c'est-à-dire autres que ceux de la bibliothèque standard de Python.</p></li>
<li><p>(1 point) Lister en commentaire en haut du fichier .py, sous vos noms et prénoms de votre binôme, les niveaux dans l'ordre (sauf le niveau
				zéro), et les points dedans, que vous avez complétés ou tenté de faire en partie. Les parties complètes peuvent être résumées par "Fait en
				entier" ou une phrase similaire. Par exemple:</p>
<pre>
Niveau 1:
	Fait en entier
Niveau 2:
	Fait en entier
Niveau 3:
	1: Fait en entier
	2:
		1
		2
	3:
		1
		6
</pre>
</li>
</ol>

		
		
		
		<h2 data-nb="25.3" id="Niveau 1: affichage du tableau vide">Niveau 1: affichage du tableau vide</h2>
<p>10 points à marquer.</p>
<p>A la fin de ce niveau, quand on l'exécute, le programme affiche un tableau de 10 colonnes et 10 lignes, puis se termine. Le tableau va devoir varier
			de taille au cours de l'exécution du programme à des niveaux ultérieurs, écrivez donc votre code pour qu'il fonctionne pour différentes tailles de
			tableau.</p>
<p>Voici le tableau qui devrait être affiché par le programme dans la console:</p>
<pre>
  |__A___|__B___|__C___|__D___|__E___|__F___|__G___|__H___|__I___|__J___|
 1|______|______|______|______|______|______|______|______|______|______|
 2|______|______|______|______|______|______|______|______|______|______|
 3|______|______|______|______|______|______|______|______|______|______|
 4|______|______|______|______|______|______|______|______|______|______|
 5|______|______|______|______|______|______|______|______|______|______|
 6|______|______|______|______|______|______|______|______|______|______|
 7|______|______|______|______|______|______|______|______|______|______|
 8|______|______|______|______|______|______|______|______|______|______|
 9|______|______|______|______|______|______|______|______|______|______|
10|______|______|______|______|______|______|______|______|______|______|
</pre>
<p>Pour que l'affichage soit correct avec des caractères bien alignés pour former un tableau, il faut que votre console utilise une police de caractère
			dite "monospace", c'est-à-dire que tous les caractères ont exactement la même largeur. Si ce n'est pas le cas, configurez la police de votre
			console.</p>
<p>Barême:</p>
		
		<h3 data-nb="25.3.1" id="1 - Dessiner les cellules">1 - Dessiner les cellules</h3>
<ol>
<li><p>(1 point) utiliser le caractère | pour dessiner les traits entre les colonnes.</p></li>
<li><p>(1 point) utiliser le caractère _ pour dessiner les traits entre les lignes. Il ne doit pas y avoir de ligne d'affichage dans la console
				entre chaque ligne du tableau. Le caractère _ est dessiné directement dans les cellules pour former leur limite visuelle inférieure. Donc il ne
				faut PAS faire:</p>
<pre>
|      |      |      |      |      |
____________________________________
|      |      |      |      |      |
____________________________________
|      |      |      |      |      |
____________________________________
		</pre>
<p>Mais bien ceci:</p>
<pre>
|______|______|______|______|______|
|______|______|______|______|______|
|______|______|______|______|______|
		</pre>
</li>
<li><p>(1 point) le tableau a 10 colonnes et 10 lignes.</p></li>
<li><p>(1 point) toutes les cellules vides (sans valeur dedans) doivent apparaître vide, sans rien dedans (à part les caractères "_" pour délimiter
				la ligne inférieure).</p></li>
</ol>
		
		<h3 data-nb="25.3.2" id="2 - Les colonnes">2 - Les colonnes</h3>
<ol>
<li><p>(1 point) afficher le tableau avec des lettres MAJUSCULES comme noms de colonnes: A, B, ... Z.</p></li>
<li><p>(1 point) les colonnes doivent toutes avoir une largeur d'au moins 6 caractères, sans compter le caractère de séparation des colonnes. La
				largeur des colonnes à l'affichage pourra changer selon le choix de l'utilisateur à un niveau ultérieur, donc écrire votre code en prévision de
				cela.</p></li>
<li>
<p>(1 point) le nom des colonnes (A, B, C...) doit être centré dans les colonnes et entouré de caractères _, c'est-à-dire qu'il faut afficher
					<br/>
<code>|__A___|__B___|</code>
<br/>
					et PAS <code>|A_____|B_____|</code>
<br/>
					ni <code>|A     |B     |</code>.
					<br/>
					Vous pouvez le coder vous-même, ou bien il existe une méthode de la classe <code>str</code> pour faire cela, à vous de <a href="https://docs.python.org/fr/3/library/stdtypes.html#string-methods">la trouver</a>.
				</p>
</li>
</ol>
		
		<h3 data-nb="25.3.3" id="3 - Les lignes">3 - Les lignes</h3>
<ol>
<li><p>(1 point) afficher les numéros de chaque ligne: 1, 2, 3...</p></li>
<li><p>(1 point) afficher les lignes à partir de 1.</p></li>
<li><p>(1 point) le numéro de ligne doit être affiché toujours sur 2 caractères pour avoir un affichage bien aligné. Pour cela plusieurs techniques
				existent, mais il est préférable d'utiliser le formatage des chaînes avec les <a href="https://docs.python.org/fr/3/tutorial/inputoutput.html#formatted-string-literals">f-strings</a> ou la méthode <a href="https://docs.python.org/fr/3/tutorial/inputoutput.html#the-string-format-method">format()</a> des <code>str</code>.</p></li>
</ol>
</div>

	
	
	
	<h2 data-nb="25.4" id="Niveau 2: menu, modification des données, largeur des colonnes">Niveau 2: menu, modification des données, largeur des colonnes</h2>
<p>15 points à marquer.</p>
<p>A la fin de ce niveau, le programme propose un menu à l'utilisateur qui lui permet de modifier la valeur de chaque cellule du tableau. Il pourra aussi
		contrôler la largeur d'affichage des colonnes du tableau.</p>
<p>Lorsqu'il est écrit dans l'énoncé "un nom de cellule incorrect ou inexistant", cela inclut également aucun nom, c'est-à-dire une chaîne vide. Cela vaut
		pour tout le CC.</p>

	
	<h3 data-nb="25.4.1" id="1 - Le menu">1 - Le menu</h3>
<video controls="" preload="none" src="img/CC_tableur/niv2.1.webm"></video>
<ol>
<li><p>(1 point) le programme affiche le tableau, puis un menu textuel, et attend le choix de l'utilisateur. Quand l'utilisateur choisit une option
			existante, le programme exécute l'action, puis ré-affiche le tableau, le menu et attend à nouveau une action à effectuer. Il se répète ainsi tant
			que l'utilisateur n'a pas choisi l'option pour stopper le programme.</p></li>
<li><p>(1 point) une action invalide dans le menu ne provoque aucune erreur, le tableau et le menu s'affichent simplement à nouveau (un message d'erreur
			qui précise que l'action est invalide peut être affiché si vous voulez).</p></li>
<li><p>(1 point) le menu propose une option (qui fonctionne) pour stopper le programme.</p></li>
</ol>
	
	<h3 data-nb="25.4.2" id="2 - Modification des données des cellules">2 - Modification des données des cellules</h3>
<video controls="" preload="none" src="img/CC_tableur/niv2.2.webm"></video>
<ol>
<li><p>(1 point) à l'aide d'une option dans le menu, permettre à l'utilisateur de donner / modifier la valeur d'une cellule du tableau. On considère
			toute valeur entrée comme une chaîne de caractères pour type de donnée, pour le moment. Le programme demande le nom d'une cellule, par exemple A1,
			H11... Puis demande une valeur.</p></li>
<li><p>(1 point) si lors de la modification de la valeur d'une cellule l'utilisateur entre une cellule inexistante ou avec un nom incorrect, afficher un
			message d'erreur et retourner au menu.</p></li>
<li><p>(1 point) les valeurs des cellules doivent être affichées dans le tableau.</p></li>
<li><p>(1 point) si le contenu d'une cellule est plus large que la cellule, tronquer l'affichage pour ne pas dépasser la largeur de la colonne. Par
			exemple si une cellule contient la valeur "Bonjour à tous", mais que la colonne ne permet que d'afficher "Bonjou" car par défaut elle fait 6
			caractères de large, alors afficher juste "Bonjou" mais la cellule contient toujours réellement "Bonjour à tous" en entier. Le fait de tronquer
			l'affichage ne doit donc pas influer sur le contenu des cellules.</p></li>
<li><p>(1 point) à l'inverse si le contenu d'une cellule est plus court que la largeur de la cellule, ajouter autant de caractères "_" que nécessaire
			pour terminer d'afficher correctement la cellule, c'est-à-dire qu'elle garde la bonne largeur visuellement, et bien afficher sa ligne inférieure.
			Vous pouvez le faire avec votre propre code, mais une méthode de la classe <code>str</code> existe pour ça.</p></li>
<li><p>(1 point) ajouter une option dans le menu pour supprimer la valeur d'une cellule du tableau. Une cellule sans valeur apparaît vide. Supprimer la
			valeur d'une cellule déjà vide ne doit rien faire ni provoquer d'erreur.</p>
</li>
<li><p>(1 point) si lors de la suppression de la valeur d'une cellule l'utilisateur entre une cellule inexistante ou avec un nom incorrect, afficher un
			message d'erreur et retourner au menu.</p></li>
</ol>
	
	<h3 data-nb="25.4.3" id="3 - Modification de la largeur des colonnes">3 - Modification de la largeur des colonnes</h3>
<video controls="" preload="none" src="img/CC_tableur/niv2.3.webm"></video>
<ol>
<li><p>(1 point) ajouter une option dans le menu pour modifier la largeur <strong>par défaut</strong> de toutes les colonnes. Le programme demande une
			largeur en caractères, et toutes les colonnes auront ensuite cette largeur (sauf celles avec une largeur spécifique, voir plus bas) tant que
			l'utilisateur ne décide pas de la modifier</p></li>
<li><p>(1 point) lors de la modification de la largeur <strong>par défaut</strong> des colonnes, afficher un message d'erreur adapté puis retour au menu
			si:</p>
<ul>
<li><p>le nombre donné n'est est pas un entier</p></li>
<li><p>le nombre n'est pas entre 1 et 20 inclus</p></li>
</ul>
</li>
<li><p>(1 point) ajouter une option dans le menu pour modifier la largeur <strong>d'une colonne en particulier</strong>. Cette colonne s'affichera
			ensuite toujours dans cette largeur et ignorera la largeur par défaut des colonnes. Le programme demande une colonne, puis sa largeur en caractères,
			et cette colonne aura ensuite cette largeur tant que l'utilisateur ne décide pas de la modifier.</p></li>
<li><p>(1 point) lors de la modification de la largeur <strong>d'une colonne en particulier</strong>, afficher un message d'erreur adapté puis retour au
			menu si:</p>
<ul>
<li><p>la colonne précisée n'existe pas</p></li>
<li><p>le nombre donné n'est est pas un entier</p></li>
<li><p>le nombre n'est pas entre 1 et 20 inclus</p></li>
</ul>
</li>
<li><p>(1 point) ajouter une option dans le menu pour réinitialiser la largeur d'affichage <strong>spécifique des colonnes qui en ont une</strong>.
			Ainsi toute les colonnes qui avaient une largeur spécifique l'oublient et auront ensuite la largeur par défaut.</p></li>
</ol>

	
	
	
	<h2 data-nb="25.5" id="Niveau 3: ajout / suppression de lignes et colonnes">Niveau 3: ajout / suppression de lignes et colonnes</h2>
<p>17 points à marquer.</p>
<p>A la fin de ce niveau, le programme permet à l'utilisateur d'ajouter et de supprimer des lignes et colonnes à différents endroits du tableau. On impose
		la limite suivante de taille au tableau: une ligne et colonne au minimum, 14 lignes et 14 colonnes au maximum.</p>

	
	<h3 data-nb="25.5.1" id="1 - Ajout de colonnes">1 - Ajout de colonnes</h3>
<video controls="" preload="none" src="img/CC_tableur/niv3.1.webm"></video>
<ol>
<li><p>(1 point) ajouter une option dans le menu pour ajouter une nouvelle colonne <strong>à la fin</strong> (après dernière colonne).</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une colonne <strong>à la fin</strong> le tableau a déjà le maximum de colonnes (voir description de ce niveau),
			afficher un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(1 point) ajouter une option dans le menu pour ajouter une nouvelle colonne <strong>à gauche</strong> d'une colonne existante. Le programme
			demande le nom d'une colonne existante, puis fait l'ajout.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une colonne <strong>à gauche</strong> d'une autre la colonne spécifiée par l'utilisateur n'existe pas, afficher
			un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une colonne <strong>à gauche</strong> d'une autre le tableau a déjà le maximum de colonnes (voir description de
			ce niveau), afficher un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(1 point) ajouter une option dans le menu pour ajouter une nouvelle colonne <strong>à droite</strong> d'une colonne existante. Le programme
			demande le nom d'une colonne existante, puis fait l'ajout.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une colonne <strong>à droite</strong> d'une autre la colonne spécifiée par l'utilisateur n'existe pas, afficher
			un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une colonne <strong>à droite</strong> d'une autre le tableau a déjà le maximum de colonnes (voir description de
			ce niveau), afficher un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(1 point) quand on ajoute une colonne, peu importe où, les largeurs spécifiques des colonnes existantes sont préservées, et les nouvelles ont la
			largeur par défaut.</p>
<video controls="" preload="none" src="img/CC_tableur/niv3.1.9.webm"></video>
<p>Exemple: la colonne B a une largeur spécifique de 10 et la largeur par défaut est de 6. Si on ajoute une colonne à gauche de B, l'ancienne
				colonne B devient la colonne C, ainsi après l'ajout de la nouvelle colonne B aura une largeur de 6 et C de 10, et il sera de même pour toutes
				les colonnes décalées. A par contre reste inchangée car elle n'est pas affectée par l'ajout de la nouvelle colonne.</p></li>
</ol>

	
	<h3 data-nb="25.5.2" id="2 - Suppression de colonnes">2 - Suppression de colonnes</h3>
<video controls="" preload="none" src="img/CC_tableur/niv3.2.webm"></video>
<ol>
<li><p>(1 point) ajouter une option dans le menu pour supprimer une colonne. Le programme demande le nom d'une colonne existante, puis la supprime.</p>
</li>
<li><p>(0.5 point) si lors de la suppression d'une colonne la colonne spécifiée par l'utilisateur n'existe pas, afficher un message qui le précise, ne
			rien faire, et retour au menu.</p></li>
<li><p>(0.5 point) si lors de la suppression d'une colonne le tableau a déjà le minimum de colonnes (voir description de ce niveau), afficher un message
			qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(1 point) quand on supprime une colonne, les largeurs spécifiques des colonnes existantes sont préservées.</p>
<p>Exemple: la colonne B a une largeur spécifique de 10, C n'a pas de largeur spécifique, et la largeur par défaut est de 6. Si on supprime B, la
				nouvelle B qui est l'ancienne C aura pour largeur celle par défaut, donc 6.</p></li>
</ol>

	
	<h3 data-nb="25.5.3" id="3 - Ajout de lignes">3 - Ajout de lignes</h3>
<video controls="" preload="none" src="img/CC_tableur/niv3.3.webm"></video>
<ol>
<li><p>(1 point) ajouter une option dans le menu pour ajouter une nouvelle ligne <strong>à la fin</strong> (après dernière ligne).</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une ligne <strong>à la fin</strong> le tableau a déjà le maximum de lignes (voir description de ce niveau),
			afficher un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(1 point) ajouter une option dans le menu pour ajouter une nouvelle ligne <strong>sous</strong> une ligne existante. Le programme demande le
			numéro d'une ligne existante (sachant que la première pour l'utilisateur est la ligne 1), puis fait l'ajout.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une ligne <strong>sous</strong> une autre la ligne spécifiée par l'utilisateur n'existe pas, afficher un message
			qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une ligne <strong>sous</strong> une autre le tableau a déjà le maximum de lignes (voir description de ce
			niveau), afficher un message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(1 point) ajouter une option dans le menu pour ajouter une nouvelle ligne <strong>au-dessus</strong> d'une ligne existante. Le programme demande
			le numéro d'une ligne existante (sachant que la première pour l'utilisateur est la ligne 1), puis fait l'ajout.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une ligne <strong>au-dessus</strong> d'une autre la ligne spécifiée par l'utilisateur n'existe pas, afficher un
			message qui le précise, ne rien faire, et retour au menu.</p></li>
<li><p>(0.5 point) si lors de l'ajout d'une ligne <strong>au-dessus</strong> d'une autre le tableau a déjà le maximum de lignes (voir description de ce
			niveau), afficher un message qui le précise, ne rien faire, et retour au menu.</p></li>
</ol>


	
	<h3 data-nb="25.5.4" id="4 - Suppression de lignes">4 - Suppression de lignes</h3>
<video controls="" preload="none" src="img/CC_tableur/niv3.4.webm"></video>
<ol>
<li><p>(1 point) ajouter une option dans le menu pour supprimer une ligne. Le programme demande le numéro d'une ligne existante (sachant que la première
			pour l'utilisateur est la ligne 1), puis la supprime.</p></li>
<li><p>(0.5 point) si lors de la suppression d'une ligne la ligne spécifiée par l'utilisateur n'existe pas, afficher un message qui le précise, ne rien
			faire, et retour au menu.</p></li>
<li><p>(0.5 point) si lors de la suppression d'une ligne le tableau a déjà le minimum de lignes (voir description de ce niveau), afficher un message qui
			le précise, ne rien faire, et retour au menu.</p></li>
</ol>

	
	
	
	<h2 data-nb="25.6" id="Niveau 4: sauvegarde dans des fichiers">Niveau 4: sauvegarde dans des fichiers</h2>
<p>8 points à marquer.</p>
<p>A la fin de ce niveau, le programme permet à l'utilisateur d'enregistrer et charger le tableau vers / depuis des fichiers .csv.</p>
<video controls="" preload="none" src="img/CC_tableur/niv4.webm"></video>
	
	<h3 data-nb="25.6.1" id="1 - Sauvegarde">1 - Sauvegarde</h3>
<ol>
<li><p>(1 point) ajouter une option dans le menu pour enregistrer le tableau dans un fichier .csv. Le programme demande à l'utilisateur un nom de
			fichier sans extension, et rajoute automatiquement l'extension <code>.csv</code> au fichier ainsi enregistré.</p>
<p>Faites votre propre recherche si vous ne connaissez pas ce format. Pour nos besoins simples, on considère qu'un fichier csv est un fichier texte
				qui représente des données tabulaires. Chaque ligne dans le fichier représente une ligne dans le tableau. Et dans chaque ligne un caractère
				spécial choisi à l'avance (voir question suivante pour savoir lequel) marque la limite entre chaque colonne.</p></li>
<li><p>(1 points) les colonnes sont séparées dans le fichier .csv par des caractères points-virgules, donc on suppose que les cellules ne contiennent
			pas de points-virgules.</p></li>
<li><p>(1 point) le fichier enregistré doit être dans le même dossier que le fichier .py du programme, pour être plus précis, dans le même dossier que
			celui de lancement de la commande Python, qu'on suppose être le même que celui du fichier .py du programme.</p></li>
<li><p>(1 point) L'enregistrement supporte bien tous les caractères existants. Donc les cellules qui contiennent du texte avec des accents et autres
			caractères spécifiques à n'importe quelle langue (caractères japonais par exemple) sont bien enregistrées correctement sans erreur.</p>
<p>Les caractères d'autres langues peuvent s'afficher sur une largeur différente des caractères "ordinaires", et ainsi décaler légèrement
				l'affichage du tableau. Tant pis, nous n'y pouvons rien.</p></li>
</ol>
	
	<h3 data-nb="25.6.2" id="2 - Chargement">2 - Chargement</h3>
<ol>
<li><p>(2 points) le programme peut charger un tableau depuis un fichier .csv dont les colonnes sont séparées par des points-virgules. On ne prend pas
			en compte le cas où un fichier serait mal formé. Ajouter une option dans le menu pour charger un tableau depuis un fichier .csv. Le tableau en cours
			est remplacé par le nouveau qui est chargé. Le programme sait lire et charger les tableaux depuis les fichiers .csv qu'il a préalablement
			sauvegardés à la demande de l'utilisateur.</p></li>
<li><p>(1 point) pour charger un fichier, le programme demande à l'utilisateur juste le nom du fichier (complet avec extension) et pas son chemin
			relatif ni aboslu.</p>
<p>Le fichier est supposé être dans le même dossier que le fichier .py du programme, pour être plus précis, dans le même dossier que celui de
				lancement de la commande Python, qu'on suppose être le même que celui du fichier .py du programme. Si l'utilisateur entre un nom de fichier
				inexistant, afficher un message d'erreur et retour au menu.</p></li>
<li><p>(1 point) Le chargement supporte bien tous les caractères existants. Donc les cellules qui contiennent du texte avec des accents et autres
			caractères spécifiques à n'importe quelle langue (caractères japonais par exemple) sont bien chargées correctement sans erreur.</p></li>
</ol>

	
	
	
	<h2 data-nb="25.7" id="Niveau 5: formules simples">Niveau 5: formules simples</h2>
<p>5 points à marquer.</p>
<p>A la fin de ce niveau, le programme permet à l'utilisateur d'entrer des formules simples pour valeur des cellules.</p>
<p>Une formule est une expression qui s'évalue à une seule valeur, comme en Python. Une formule commence toujours par le signe <code>=</code>. L'utilisateur
		doit pouvoir écrire plusieurs opérateurs + - * / dans une même formule, et le calul se fera correctement, c'est à dire <strong>en respectant l'ordre des
			priorités</strong>. On suppose qu'il y a toujours au moins un caractère espace entre les opérateurs et les opérandes, mais il peut y en avoir plus,
		y compris au début et à la fin de l'expression.</p>
<video controls="" preload="none" src="img/CC_tableur/niv5.webm"></video>
<ol>
<li><p>(2 points) ajouter le support des formules dans les cellules, c'est à dire que chaque cellule reconnait automatiquement quand sa valeur est une
			formule, et elle affiche le résultat <strong>correct</strong> de sa formule. En cas d'expression invalide, afficher <code>#Err</code> dans la
			cellule.</p>
<p>Vous pouvez utiliser la fonction builtin <a href="https://docs.python.org/fr/3/library/functions.html?l#eval"><code>eval()</code></a>, ou bien
				faire le calcul avec votre propre code comme dans le TP de la calculatrice.</p></li>
<li><p>(1 point) ajouter dans le menu l'option pour voir le contenu brut d'une cellule, donc si elle a une formule, c'est comme ça qu'on pourra la voir,
			car l'affichage du tableau montre désormais la valeur calculée des cellules contenant une formule. Le programme demande à l'utilisateur le nom d'une
			cellule existante, par exemple A1 ou J11, et affiche sa valeur, non calculée s'il s'agit d'une formule, et ensuite retour au menu. Cette option
			montre la valeur brute de toute cellule, qu'elle soit vide, qu'elle contienne une valeur simple, ou qu'elle contienne une formule correcte ou
			erronée.</p>
</li>
<li><p>(1 point) si pour avoir la valeur brute d'une cellule l'utilisateur entre une cellule inexistante ou avec un nom incorrect, afficher un message
			d'erreur et retourner au menu.</p></li>
<li><p>(1 point) lors de l'enregistrement dans des fichiers .csv, les formules sont calculées et c'est leur valeur finale qui est enregistrée dans le
			fichier, donc les fichiers .csv ne préservent pas les formules.</p></li>
</ol>

	
	
	
	<h2 data-nb="25.8" id="Niveau 6: formules avec références">Niveau 6: formules avec références</h2>
<p>9 points à marquer, plus 3 en bonus donc qui peuvent donner une note au-delà du maximum.</p>
<p>A la fin de ce niveau, le programme permet à l'utilisateur d'entrer des formules comme précédemment, mais en plus en utilisant des noms d'autres cellules
		afin d'utiliser leur valeur dans le calcul, ce sont donc des références vers d'autres cellules.</p>

	
	<h3 data-nb="25.8.1" id="1 - Support des références vers des valeurs simples">1 - Support des références vers des valeurs simples</h3>
<video controls="" preload="none" src="img/CC_tableur/niv6.1.webm"></video>
<ol>
<li><p>(2 points) les opérandes dans les formules peuvent aussi être des noms de cellules du tableau, le calcul se fera alors en utilisant la valeur des
			cellules ainsi référencées. On ne considère pas les cas où une cellule référencée est aussi elle-même une formule, on ne considère que les
			références vers des cellules avec une valeur simple.</p>
<p>Par exemple la cellule contenant la formule <code>=B1 + C1</code> affichera <code>10</code> si B1 a pour valeur <code>2</code> et C1
				<code>8</code>.</p></li>
<li><p>(1 point) si une formule référence une ou plusieurs cellules vides, ou des cellules qui ne contiennent pas des nombres, et ainsi ne peut pas
			calculer son résultat, ce n'est pas grave, elle affiche alors <code>#Err</code>. Les références aux cellules vides peuvent aussi afficher
			<code>None</code>.</p>
<p>Par exemple la cellule contenant la formule <code>=C1 + 2</code> affichera <code>#Err</code> si C1 vaut <code>Bonjour</code> ou est vide.</p>
</li>
</ol>
	
	<h3 data-nb="25.8.2" id="2 - Maintien des références en cas d'ajout et suppression de lignes et colonnes">2 - Maintien des références en cas d'ajout et suppression de lignes et colonnes</h3>
<video controls="" preload="none" src="img/CC_tableur/niv6.2.webm"></video>
<p>Attention lors d'ajout / suppression de lignes et colonnes, les cellules "bougent" dans le tableau, et donc les références aux cellules doivent être
		changées de façon à garder les formules correctes. Et une référence vers une cellule dans une ligne ou colonne supprimée devient erronée. Si les
		formules deviennent erronées leur cellule affiche <code>#Err</code>. On ne prend pas en compte les boucles, c'est-à-dire quand deux ou plusieurs
		cellules ont besoin l'une de l'autre pour être calculées.</p>
<ol>
<li><p>(1 point) lors de la suppression d'une colonne: les références vers les cellules dans une colonne supprimée deviennent erronées, les cellules qui
			contiennent une formule qui référence ces cellules inexistantes doivent donc afficher <code>#Err</code>. A vous de voir ce que deviennent les
			formules en elles-mêmes, qui contiennent ces références erronées.</p></li>
<li><p>(1 point) lors de la suppression d'une colonne: les références vers les cellules <strong>à droite</strong> de la colonne supprimée doivent être
			décalées d'une colonne vers <strong>la gauche</strong>. Les références vers des cellules à gauche de la colonne supprimée doivent rester inchangées.
		</p></li>
<li><p>(1 point) lors de l'ajout d'une colonne: les références vers les cellules <strong>à droite</strong> de la nouvelle colonne ajoutée doivent être
			décalées d'une colonne vers <strong>la droite</strong>. Les références vers des cellules à gauche de la nouvelle colonne doivent rester inchangées.
		</p>
</li>
<li><p>(1 point) lors de la suppression d'une ligne: les références vers les cellules dans une ligne supprimée deviennent erronées, les cellules qui
			contiennent une formule qui référence ces cellules inexistantes doivent donc afficher <code>#Err</code>. A vous de voir ce que deviennent les
			formules en elles-mêmes, qui contiennent ces références erronées.</p></li>
<li><p>(1 point) lors de la suppression d'une ligne: les références vers les cellules <strong>en bas</strong> de la ligne supprimée doivent être
			décalées d'une ligne vers <strong>le haut</strong>. Les références vers des cellules en haut de la ligne supprimée doivent rester inchangées.</p>
</li>
<li><p>(1 point) lors de l'ajout d'une ligne: les références vers les cellules <strong>en bas</strong> de la nouvelle ligne ajoutée doivent être
			décalées d'une ligne vers <strong>le bas</strong>. Les références vers des cellules en haut de la nouvelle ligne doivent rester inchangées.</p>
</li>
</ol>
	
	<h3 data-nb="25.8.3" id="3 - Support des références vers d'autres formules">3 - Support des références vers d'autres formules</h3>
<video controls="" preload="none" src="img/CC_tableur/niv6.3.webm"></video>
<ol>
<li><p>(3 points bonus) Ajouter le support des références dans une formule vers d'autres cellules de type formule, qui peuvent elles-mêmes contenir des
			références et ainsi de suite. On ne prend toujours pas en compte les boucles (cellules qui finissent par se référencer elles-mêmes)</p></li>
</ol>

	
		<div class="correction">
<pre class="line-numbers"><code class="language-python">
ALPHABET = "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"
TAILLE_MAX_X = 14
TAILLE_MAX_Y = 14
NIVEAU_A_EXECUTER = 6
TAILLE_INITIALE_TABLEAU_X = 10
TAILLE_INITIALE_TABLEAU_Y = 10
largeur_colonnes_défaut = 6
largeur_colonnes_spécifiques = [None for _ in range(TAILLE_INITIALE_TABLEAU_X)]
tableau = [[None for j in range(TAILLE_INITIALE_TABLEAU_Y)] for i in range(TAILLE_INITIALE_TABLEAU_X)]


def calculer_valeur_str_cellule(valeur_cellule):
	"""
	Retourne une chaine qui peut être affichée à l'utilisateur comme contenu la cellule.
	Ne prend pas en compte la largeur de la cellule, juste son contenu.
	"""
	if type(valeur_cellule) is str and valeur_cellule[0] == "=":
		try:
			formule: str = valeur_cellule[1:]
			i = 0
			while i &lt; len(formule):
				c = formule[i]
				try:
					no_colonne = ALPHABET.index(c)
					longueur_no_ligne = -1
					try:
						no_ligne = int(formule[i + 1:i + 3]) - 1
						longueur_no_ligne = 2
					except:
						# Ligne pas sur 2 caractères
						try:
							no_ligne = int(formule[i + 1:i + 2]) - 1
							longueur_no_ligne = 1
						except:
							# Ligne pas sur 1 caractère
							return "#Err"
					if longueur_no_ligne != -1:
						valeur_cellule_ref = calculer_valeur_str_cellule(tableau[no_colonne][no_ligne])
						# indice_début = i - 1 if i - 1 &gt;= 0 else 0
						indice_début = i
						formule = formule[:indice_début] + str(valeur_cellule_ref) + formule[indice_début + longueur_no_ligne + 1:]
						i += longueur_no_ligne  # -1 car on fait plus un après, dans tous les cas
				except:
					# Pas un nom de colonne
					pass
				i += 1
			return str(eval(formule))
		except:
			return "#Err"
	return str(valeur_cellule)


def afficher_tableau():
	ligne0 = "  |"
	for x in range(len(tableau)):
		x_restant = x
		while x_restant &gt; 0:
			x_restant -= 25
		largeur_colonne = largeur_colonnes_spécifiques[x]
		if not largeur_colonne:
			largeur_colonne = largeur_colonnes_défaut
		ligne0 += ALPHABET[x].center(largeur_colonne, "_") + "|"
	print(ligne0)
	for y in range(len(tableau[0])):
		ligne_str = f"{y + 1:2}" + "|"
		for x in range(len(tableau)):
			largeur_colonne = largeur_colonnes_spécifiques[x]
			if not largeur_colonne:
				largeur_colonne = largeur_colonnes_défaut
			if tableau[x][y] != None:  # != None car tableau[x][y] peut valoir 0
				cellule_val_str = calculer_valeur_str_cellule(tableau[x][y])
				ligne_str += cellule_val_str.ljust(largeur_colonne, "_")[:largeur_colonne] + "|"
			else:
				ligne_str += "_" * largeur_colonne + "|"
		print(ligne_str)


if NIVEAU_A_EXECUTER == 1:
	afficher_tableau()
else:
	def demander_cellule_utilisateur():
		"""
		Retourne un tuple x,y qui est la position de la cellule dans le tableau, None si choix invalide
		"""
		nom_cellule = input("Cellule: ")
		try:
			colonne_cellule = ALPHABET.index(nom_cellule[0])
			ligne_cellule = int(nom_cellule[1:]) - 1  # -1 car l'utilisateur compte à partir de 1, et nous à partir de 0
			if colonne_cellule &lt; 0 or colonne_cellule &gt;= len(tableau) or ligne_cellule &lt; 0 or ligne_cellule &gt;= len(tableau[0]):
				print("Nom de cellule invalide")
				return
			return colonne_cellule, ligne_cellule
		except:
			print("Nom de cellule invalide")


	def demander_colonne_utilisateur():
		"""
		Retourne un entier qui est le numéro de la colonne dans le tableau, None si choix invalide
		"""
		nom_colonne = input("Colonne: ")
		try:
			no_colonne = ALPHABET.index(nom_colonne)
			if no_colonne &lt; 0 or no_colonne &gt;= len(tableau):
				print("Colonne invalide")
				return
			return no_colonne
		except:
			print("Nom de colonne invalide")


	def demander_ligne_utilisateur():
		"""
		Retourne un entier qui est le numéro de la ligne dans le tableau, None si choix invalide
		"""
		try:
			no_ligne = int(input("Ligne: ")) - 1
			if no_ligne &lt; 0 or no_ligne &gt;= len(tableau[0]):
				print("Ligne invalide")
				return
			return no_ligne
		except:
			print("Numéro de ligne invalide")


	def décaler_références_formules_colonnes(no_colonne_début, direction):
		"""
		direction est soit "gauche" soit "droite".

		Les formules à partir de no_colonne_début, et toutes celles à droite, verront leurs références décalées d'une colonne à gauche ou à droite
		selon la direction choisie.
		Par exemple =E5 + B5 deviendra =D5 + A5, si on décale vers la gauche.
		Par exemple =E5 + B5 deviendra =F5 + C5, si on décale vers la droite.

		Les références à la colonne A deviendront invalides si on décale à gauche à partir de A.
		Ou plutôt : toutes les références aux cellules dans la colonne no_colonne_début deviennent invalides si on décale à gauche
		"""
		décalage_indice_alphabet = - 1
		if direction == "droite":
			décalage_indice_alphabet = +1

		for colonne_nb, colonne in enumerate(tableau):
			for ligne_nb, ligne in enumerate(colonne):
				i = 0
				if type(ligne) is str and ligne[0] == "=":
					while i &lt; len(ligne):
						c = ligne[i]
						try:
							indice_colonne = ALPHABET.index(c)
							# On décale dans les deux sens les références aux colonnes strictement à droite de celle à partir de laquelle faire le décalage,
							# et aussi celle directement sur la colonne de début mais seulement si on décale à droite
							if indice_colonne &gt; no_colonne_début or indice_colonne == no_colonne_début and direction == "droite":
								nom_nlle_colonne = ALPHABET[indice_colonne + décalage_indice_alphabet]
								ligne = ligne[:i] + nom_nlle_colonne + ligne[i + 1:]
							# pour les références directement sur la colonnes de départ, et si on doit décaler à gauche, on les rend invalides
							elif indice_colonne == no_colonne_début and direction == "gauche":
								nom_nlle_colonne = "Ø"
								ligne = ligne[:i] + nom_nlle_colonne + ligne[i + 1:]
						except:
							pass
						i += 1
				colonne[ligne_nb] = ligne


	def décaler_références_formules_lignes(no_ligne_début, direction):
		"""
		direction est soit "haut" soit "bas".

		Même chose que pour la fonction de décalage des colonnes, mais cette fois-ci pour les lignes.
		"""
		décalage_lignes = - 1
		if direction == "bas":
			décalage_lignes = +1

		for colonne_nb, colonne in enumerate(tableau):
			for ligne_nb, valeur_cellule in enumerate(colonne):
				i = 0
				if type(valeur_cellule) is str and valeur_cellule[0] == "=":
					while i &lt; len(valeur_cellule):
						c = valeur_cellule[i]
						try:
							# Si trouvé une référence à une colonne
							no_colonne = ALPHABET.index(c)
							longueur_no_ligne = -1
							try:
								# Tentative d'avoir numéro de ligne sur 2 caractères
								no_ligne_ref = int(valeur_cellule[i + 1:i + 3])
								longueur_no_ligne = 2
							except:
								try:
									# Tentative d'avoir numéro de ligne sur 1 caractère
									no_ligne_ref = int(valeur_cellule[i + 1:i + 2])
									longueur_no_ligne = 1
								except:
									# Aucun no de ligne =&gt; mauvaise formule, mais on continue à décaler les autres références
									i += 1
									continue
							# Si on a trouvé un numéro de ligne correct
							if longueur_no_ligne != -1:
								# On décale dans les deux sens les références aux lignes strictement en dessous de celle à partir de laquelle faire le décalage,
								# et aussi celle directement sur la ligne de début mais seulement si on décale vers le bas
								if no_ligne_ref &gt; no_ligne_début or no_ligne_ref == no_ligne_début and direction == "bas":
									no_nlle_ligne_ref = no_ligne_ref + décalage_lignes
									valeur_cellule = valeur_cellule[:i + 1] + str(no_nlle_ligne_ref) + valeur_cellule[i + 1 + longueur_no_ligne:]
								# Pour les références directement sur la ligne de départ, et si on doit décaler vers le haut, on les rend invalides
								elif no_ligne_ref == no_ligne_début and direction == "haut":
									no_nlle_ligne_ref = "Ø"
									valeur_cellule = valeur_cellule[:i + 1] + str(no_nlle_ligne_ref) + valeur_cellule[i + 1 + longueur_no_ligne:]
						except:
							# Caractère actuel pas une référence vers un nom de colonne
							# ou bien la ligne n'était pas une existante
							pass
						i += 1
				colonne[ligne_nb] = valeur_cellule


	# Boucle principale
	while True:
		afficher_tableau()
		print("m - modifier donnée cellule")
		print("s - supprimer donnée cellule")
		print("ml - modifier la largeur par défaut de toutes les colonnes")
		print("mlc - modifier la largeur d'une colonne spécifique")
		print("rl - réinitialiser largeur de toutes les colonnes à la largeur par défaut")
		if NIVEAU_A_EXECUTER &gt;= 3:
			print("acf - ajouter une colonne à la fin")
			print("acd - ajouter une colonne à droite d'une autre")
			print("acg - ajouter une colonne à gauche d'une autre")
			print("alf - ajouter une ligne à la fin")
			print("alh - ajouter une ligne en haut d'une autre")
			print("alb - ajouter une ligne en bas d'une autre")
			print("sc - supprimer une colonne")
			print("sl - supprimer une ligne")
		if NIVEAU_A_EXECUTER &gt;= 4:
			print("st - sauvegarder tableau dans fichier .csv")
			print("ct - charger tableau depuis fichier .csv")
		if NIVEAU_A_EXECUTER &gt;= 5:
			print("vc - voir contenu brut cellule")
		print("q - quitter")
		choix_utilisateur = input("Votre choix: ")

		######################################################## Modif / suppression données cellules
		if choix_utilisateur == "m":
			try:
				colonne_cellule, ligne_cellule = demander_cellule_utilisateur()
				valeur = input("Valeur: ")
				tableau[colonne_cellule][ligne_cellule] = None if not valeur else valeur
			except:
				pass

		elif choix_utilisateur == "s":
			try:
				colonne_cellule, ligne_cellule = demander_cellule_utilisateur()
				tableau[colonne_cellule][ligne_cellule] = None
			except:
				pass

		######################################################## Modif largeur des colonnes
		elif choix_utilisateur == "ml":
			try:
				largeur_demandée = int(input("Largeur: "))
				if largeur_demandée &lt; 1 or largeur_demandée &gt; 20:
					print("La largeur doit être entre 1 et 20")
				else:
					largeur_colonnes_défaut = largeur_demandée
			except:
				print("Nombre invalide")

		elif choix_utilisateur == "mlc":
			no_colonne = demander_colonne_utilisateur()
			if no_colonne != None:
				try:
					largeur_demandée = int(input("Largeur: "))
					if largeur_demandée &lt; 1 or largeur_demandée &gt; 20:
						print("La largeur doit être entre 1 et 20")
					else:
						largeur_colonnes_spécifiques[no_colonne] = largeur_demandée
				except:
					print("Nombre invalide")

		elif choix_utilisateur == "rl":
			for i in range(len(largeur_colonnes_spécifiques)):
				largeur_colonnes_spécifiques[i] = None

		######################################################## Ajout / suppression de colonnes
		elif choix_utilisateur in ("acf", "acg", "acd"):
			if len(tableau) &gt;= TAILLE_MAX_X:
				print("Nombre maximum de colonnes atteint")
			else:
				if choix_utilisateur == "acf":
					tableau.append([None for j in range(len(tableau[0]))])
					largeur_colonnes_spécifiques.append(None)
				# Inutile de décaler les références, aucune référence possible à droite de cette nouvelle dernière colonne
				else:
					no_colonne = demander_colonne_utilisateur()
					if no_colonne != None:  # préciser != None car le numéro peut être zéro, ce qui évalue à False si on fait juste if no_colonne
						indice_ajout_nlle_colonne = no_colonne  # par défaut on ajoute à gauche
						if choix_utilisateur == "acd":
							indice_ajout_nlle_colonne += 1
						tableau.insert(indice_ajout_nlle_colonne, [None for j in range(len(tableau[0]))])
						largeur_colonnes_spécifiques.insert(indice_ajout_nlle_colonne, None)
						décaler_références_formules_colonnes(indice_ajout_nlle_colonne, "droite")

		elif choix_utilisateur == "sc":
			if len(tableau) &lt;= 1:
				print("Nombre minimum de colonnes atteint")
			else:
				no_colonne_à_suppr = demander_colonne_utilisateur()
				if no_colonne_à_suppr != None:  # préciser != None car le numéro peut être zéro, ce qui évalue à False si on fait juste if no_colonne
					del tableau[no_colonne_à_suppr]
					del largeur_colonnes_spécifiques[no_colonne_à_suppr]
					décaler_références_formules_colonnes(no_colonne_à_suppr, "gauche")

		######################################################## Ajout / suppression de lignes
		elif choix_utilisateur in ("alf", "alh", "alb"):
			if len(tableau[0]) &gt;= TAILLE_MAX_Y:
				print("Nombre maximum de lignes atteint")
			else:
				if choix_utilisateur == "alf":
					for no_colonne in tableau:
						no_colonne.append(None)
				else:
					no_ligne = demander_ligne_utilisateur()
					if no_ligne != None:  # préciser != None car le numéro peut être zéro, ce qui évalue à False si on fait juste if no_colonne
						indice_ajout_nlle_ligne = no_ligne  # par défaut on ajoute en haut
						if choix_utilisateur == "alb":
							indice_ajout_nlle_ligne += 1
						for no_colonne in tableau:
							no_colonne.insert(indice_ajout_nlle_ligne, None)
						décaler_références_formules_lignes(indice_ajout_nlle_ligne + 1, "bas")  # +1 parce que les formules comptent les lignes à partir de 1

		elif choix_utilisateur == "sl":
			if len(tableau[0]) &lt;= 1:
				print("Nombre minimum de lignes atteint")
			else:
				no_ligne_à_supprimer = demander_ligne_utilisateur()
				if no_ligne_à_supprimer != None:  # préciser != None car le numéro peut être zéro, ce qui évalue à False si on fait juste if no_colonne
					for no_colonne in tableau:
						del no_colonne[no_ligne_à_supprimer]
					décaler_références_formules_lignes(no_ligne_à_supprimer + 1, "haut")  # +1 parce que les formules comptent les lignes à partir de 1

		######################################################## Voir contenu brut d'une cellule
		elif choix_utilisateur == "vc":
			try:
				colonne_cellule, ligne_cellule = demander_cellule_utilisateur()
				print("Valeur brute de la cellule:", tableau[colonne_cellule][ligne_cellule])
			except:
				pass

		######################################################## Sauvegarder /charger le tableau
		elif choix_utilisateur == "st":
			nom_fichier = input("Nom fichier (sans extension): ")
			f = open(nom_fichier + ".csv", "w", encoding="utf-8")
			for j in range(len(tableau[0])):
				ligne_str = ""
				for i in range(len(tableau)):
					valeur_calculée_str_cellule = calculer_valeur_str_cellule(tableau[i][j])
					if valeur_calculée_str_cellule == "None":
						ligne_str += ";"
					else:
						ligne_str += valeur_calculée_str_cellule + ";"
				f.write(ligne_str[:-1] + "\n")  # on ignore le dernier ; car il ne délimite aucune colonne
			f.close()

		elif choix_utilisateur == "ct":
			nom_fichier = input("Nom fichier (avec extension): ")
			try:
				f = open(nom_fichier, "r", encoding="utf-8")
				# On va stocker les données du fichier dans un tableau indexé par les lignes d'abord, colonnes ensuite, car on lit le fichier ligne par ligne
				tableau_lignes_colonnes = []
				for ligne in f:
					tableau_lignes_colonnes.append(ligne[:-1].split(";"))  # on ne considère pas le dernier caractère parce qu'il est le saut de ligne \n
					# Remplacement des chaines vides par None
					for colonne_nb, no_colonne in enumerate(tableau_lignes_colonnes[-1]):
						if no_colonne == "":
							tableau_lignes_colonnes[-1][colonne_nb] = None
				f.close()
				# On construit le véritable tableau en faisant une rotation du premier, indexé par les colonnes d'abord, les lignes ensuites
				tableau = [[None for _ in tableau_lignes_colonnes] for _ in
						   tableau_lignes_colonnes[0]]  # crée autant de colonnes qu'il y a de valeurs dans la 1er ligne de tableau2
				for ligne_nb, ligne in enumerate(tableau_lignes_colonnes):
					for colonne_nb, valeur_colonne in enumerate(ligne):
						tableau[colonne_nb][ligne_nb] = valeur_colonne
			except:
				print("Fichier invalide")

		######################################################## Quitter
		elif choix_utilisateur == "q":
			break
			</code></pre>
</div>
	


		<div class="nav_arrows" style=" margin-bottom: 1em;">

			<div style="text-align: center; opacity: 0.5; font-size: small">

			</div>
		</div>

	</div>

	
		<style>
			@media only screen and (min-width: 70em) {
				#side_nav_bar {
					width: 25vw;
				}

				#contenu {
					width: 75vw;
				}
			}
		</style>
	


</div>
  
<script src="prism.js"></script>

<script>
	if (document.URL.indexOf("localhost") === -1) {
		//console.log("pas localhost");
		document.querySelector("link[rel = 'icon']").setAttribute("href", "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='200' height='200' viewBox='0 0 100 100' style='display:block; margin:auto; padding: 0 0 1em 0;'%3E%3Cstyle%3E text %7B text-align: center; fill: white; text-anchor: middle; font-size: 11pt; %3C/style%3E%3C!--	%3Crect fill='hsl(000,50%25, 50%25)' x='0' y='0' width='100' height='100'%3E%3C/rect%3E--%3E%3Crect fill='hsl(200,50%25, 50%25)' x='0' y='0' width='100' height='100'%3E%3C/rect%3E%3Ctext x='50' y='75' style='font-size: 50pt;' id='t'%3E 🐍 %3C/text%3E%3C!--	%3Canimate--%3E%3C!-- xlink:href='%23t'--%3E%3C!-- attributeName='y'--%3E%3C!-- calcMode='spline'--%3E%3C!-- values='60; 90; 60'--%3E%3C!-- keyTimes='0; 0.5; 1'--%3E%3C!-- keySplines='--%3E%3C!-- .42 0 1 1;--%3E%3C!-- 0 0 .59 1;'--%3E%3C!-- dur='2s'--%3E%3C!-- fill='freeze'--%3E%3C!-- repeatCount='indefinite'/%3E--%3E%3C/svg%3E");
	} else {
		//console.log("localhost");
	}
	// On supprime la première ligne des <pre><code> qui est considérée toujours vide et inutile
	const codes = document.querySelectorAll('pre[class="affichage_console"] code');
	
	codes.forEach(function (el) {
		// Attention: modifier textContent ou innerText d'un élément détruit tous ses éléments enfant :(
		//el.textContent = el.textContent.replace(/^\n/, '');
		// On modifie donc le premie noeud texte uniquement
		el.childNodes[0].textContent = el.childNodes[0].textContent.replace(/^\n/, ''); // suppose que c'est un élément texte
	});

	// On ajoute un <br> avant et après chaque <pre>
	let pres = document.querySelectorAll('pre, .exercices div.noté');
	pres.forEach(function (el) {
		el.parentNode.insertBefore(document.createElement('div'), el);
		el.parentNode.insertBefore(document.createElement('div'), el.nextSibling);
	});

	// On ajoute 'Affichage' avant chaque affichage console
	pres = document.querySelectorAll('pre[class="affichage_console"]');
	pres.forEach(function (el) {
		const p = document.createElement('p');
		p.innerHTML = `<small>↓ Affichage dans la console (ou dans le shell, selon où vous lancez l'exécution)<mall>`;
		p.classList.add("légende_placée_en_haut");
		el.parentNode.insertBefore(p, el);
	});

	// Cacher corrections dans les TD / TP, et permettre de les afficher
	let divs_correction = document.querySelectorAll('div[class="correction"]');
	divs_correction.forEach(function (div) {
		div.classList.add("correction_hidden");
		const p = document.createElement('p');
		p.innerHTML = `<span class="correction_lien_à_cliquer">📝 Afficher / cacher correction ✓</span>`;
		p.onclick = function (evt) {
			div.classList.toggle("correction_hidden");
		};
		div.parentNode.insertBefore(p, div);
	});
</script>
</body>
</html>